{% extends 'app/base.html' %}
{% load crispy_forms_tags %}

{% block title %}Approve Penerimaan Part{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-6 col-md-8 mx-auto">

        <a href="{% url 'dashboard' %}" class="btn btn-sm btn-outline-secondary mb-3">
            <i class="bi bi-arrow-left me-1"></i> Kembali ke Dashboard
        </a>

        <div class="card card-glossy shadow-lg">

            <div class="card-header card-header-professional text-white">
                <h1 class="h4 mb-0"><i class="bi bi-patch-check me-2"></i> Setujui Penerimaan Spare Part</h1>
            </div>

            <div class="card-body p-4 p-md-5">

                <h2 class="h5 mb-4 text-primary text-center">Detail Permintaan Part</h2>

                <ul class="list-group list-group-flush mb-5 border rounded">
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <strong>Part Diminta:</strong>
                        <span class="fw-bold text-success">{{ part_request.part_name }}</span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <strong>Jumlah Part:</strong>
                        <span class="badge bg-primary fs-6">{{ part_request.quantity_needed }}</span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <strong>Untuk SKU:</strong>
                        <span class="text-dark">{{ sku.sku_id }} ({{ sku.name }})</span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <strong>Teknisi Peminta:</strong>
                        <span class="text-muted small">{{ part_request.qc_form.technician.username }}</span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <strong>Dikeluarkan oleh:</strong>
                        <span class="text-muted small">{{ part_request.warehouse_manager.username|default:"Warehouse Manager" }}</span>
                    </li>
                </ul>

                <form method="POST">
                    {% csrf_token %}

                    <div class="d-grid gap-3">
                        <button type="submit" name="approve" class="btn btn-success btn-lg shadow-sm">
                            <i class="bi bi-check-circle me-2"></i>
                            Approve Penerimaan
                        </button>

                        <button type="submit" name="reject" class="btn btn-outline-danger btn-lg"
                                onclick="return confirm('Anda yakin ingin menolak part ini dan mengembalikannya ke Warehouse Manager?')">
                            <i class="bi bi-x-circle me-2"></i>
                            Reject (Kembalikan ke WM)
                        </button>
                    </div>
                </form>

            </div>
        </div>
    </div>
</div>
{% endblock %}