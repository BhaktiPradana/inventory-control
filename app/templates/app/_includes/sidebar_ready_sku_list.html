<div class="card shadow-sm mt-4">
    <div class="card-header bg-success text-white">
        <h3 class="h6 mb-0">List SKU Siap Jual</h3>
    </div>

    <ul class="nav nav-tabs nav-fill" id="readySkuTab" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="gudang-tab" data-bs-toggle="tab" data-bs-target="#gudang-tab-pane" type="button" role="tab" aria-controls="gudang-tab-pane" aria-selected="true">
                Ready
                <span class="badge bg-dark rounded-pill">
                    {{ ready_skus_list.count|default:0 }}
                </span>
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="toko-tab" data-bs-toggle="tab" data-bs-target="#toko-tab-pane" type="button" role="tab" aria-controls="toko-tab-pane" aria-selected="false">
                Ready Store
                <span class="badge bg-dark rounded-pill">
                    {{ shop_skus_list.count|default:0 }}
                </span>
            </button>
        </li>
    </ul>

    <div class="p-2 bg-light border-bottom">
        <input type="text" id="readySkuSearchInput" class="form-control form-control-sm" placeholder="Cari SKU Ready/Store..." autocomplete="off">
    </div>

    <div class="tab-content" id="readySkuTabContent">

        <div class="tab-pane fade show active" id="gudang-tab-pane" role="tabpanel" aria-labelledby="gudang-tab" tabindex="0">
            <div style="max-height: 300px; overflow-y: auto;">
                <ul class="list-group list-group-flush">
                    {% for sku in ready_skus_list %}
                    <li class="list-group-item d-flex justify-content-between align-items-center py-2 ready-sku-item">
                        <a href="#"
                           class="text-decoration-none fw-bold sku-id-text"
                           data-bs-toggle="modal"
                           data-bs-target="#skuHistoryModal"
                           data-sku-id="{{ sku.id }}"
                           style="font-size: 0.9em;">
                            {{ sku.sku_id }} <i class="bi bi-search ms-1" style="font-size: 0.8rem;"></i>
                        </a>
                        <span class="text-muted small" style="font-size: 0.8em;">{{ sku.name|truncatechars:15 }}</span>
                    </li>
                    {% empty %}
                    <li class="list-group-item text-center text-muted p-3">
                        Tidak ada SKU Ready.
                    </li>
                    {% endfor %}
                    <li class="list-group-item text-center text-muted p-3 no-gudang-match" style="display: none;">
                        SKU tidak ditemukan.
                    </li>
                </ul>
            </div>
        </div>

        <div class="tab-pane fade" id="toko-tab-pane" role="tabpanel" aria-labelledby="toko-tab" tabindex="0">
            <div style="max-height: 300px; overflow-y: auto;">
                <ul class="list-group list-group-flush">
                    {% for sku in shop_skus_list %}
                    <li class="list-group-item d-flex justify-content-between align-items-center py-2 ready-sku-item">
                        <a href="#"
                           class="text-decoration-none fw-bold sku-id-text"
                           data-bs-toggle="modal"
                           data-bs-target="#skuHistoryModal"
                           data-sku-id="{{ sku.id }}"
                           style="font-size: 0.9em;">
                            {{ sku.sku_id }} <i class="bi bi-search ms-1" style="font-size: 0.8rem;"></i>
                        </a>
                        <span class="text-muted small" style="font-size: 0.8em;">{{ sku.name|truncatechars:15 }}</span>
                    </li>
                    {% empty %}
                    <li class="list-group-item text-center text-muted p-3">
                        Tidak ada SKU Ready di Store.
                    </li>
                    {% endfor %}
                    <li class="list-group-item text-center text-muted p-3 no-toko-match" style="display: none;">
                        SKU tidak ditemukan.
                    </li>
                </ul>
            </div>
        </div>

    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const readySearchInput = document.getElementById('readySkuSearchInput');

        if (readySearchInput) {
            readySearchInput.addEventListener('keyup', function (e) {
                const term = e.target.value.toLowerCase();

                // --- Filter Tab Gudang ---
                const gudangRows = document.querySelectorAll('#gudang-tab-pane .ready-sku-item');
                let hasGudangResult = false;
                gudangRows.forEach(row => {
                    const skuText = row.querySelector('.sku-id-text').textContent.toLowerCase();
                    if (skuText.includes(term)) {
                        row.style.display = '';
                        hasGudangResult = true;
                    } else {
                        row.style.display = 'none';
                    }
                });
                const noGudangMsg = document.querySelector('#gudang-tab-pane .no-gudang-match');
                if (noGudangMsg) {
                    noGudangMsg.style.display = hasGudangResult ? 'none' : '';
                }

                // --- Filter Tab Toko ---
                const tokoRows = document.querySelectorAll('#toko-tab-pane .ready-sku-item');
                let hasTokoResult = false;
                tokoRows.forEach(row => {
                    const skuText = row.querySelector('.sku-id-text').textContent.toLowerCase();
                    if (skuText.includes(term)) {
                        row.style.display = '';
                        hasTokoResult = true;
                    } else {
                        row.style.display = 'none';
                    }
                });
                const noTokoMsg = document.querySelector('#toko-tab-pane .no-toko-match');
                if (noTokoMsg) {
                    noTokoMsg.style.display = hasTokoResult ? 'none' : '';
                }
            });
        }
    });
</script>